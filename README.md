# Verusè‡ªåŠ¨è¯æ˜ç”Ÿæˆå’ŒéªŒè¯ç³»ç»Ÿ

è¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„Veruså½¢å¼åŒ–éªŒè¯ç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆOpenAI GPT-4oï¼‰è‡ªåŠ¨ç”Ÿæˆå’Œä¿®å¤Rust/Verusä»£ç çš„å½¢å¼åŒ–è¯æ˜ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– ä½¿ç”¨OpenAI GPT-4oæ¨¡å‹è‡ªåŠ¨ç”Ÿæˆå½¢å¼åŒ–è¯æ˜
- ğŸ”„ è‡ªåŠ¨è¿­ä»£ä¿®å¤ï¼Œæœ€å¤šæ”¯æŒ5æ¬¡ä¿®å¤å°è¯•
- ğŸ“ å®Œå–„çš„æ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼Œä¿å­˜æ‰€æœ‰è¿­ä»£å†å²
- ğŸ¯ é«˜è´¨é‡çš„promptå·¥ç¨‹ï¼Œä¸“é—¨é’ˆå¯¹Verusä¼˜åŒ–
- âš¡ æ”¯æŒæ¨ç†æ¨¡å¼ï¼Œç¡®ä¿è¯æ˜è´¨é‡

## ç³»ç»Ÿè¦æ±‚

- Python 3.8+
- VeruséªŒè¯å™¨
- OpenAI APIè®¿é—®æƒé™
- condaç¯å¢ƒï¼ˆæ¨èä½¿ç”¨markerç¯å¢ƒï¼‰

## å®‰è£…å’Œé…ç½®

1. ç¡®ä¿å·²å®‰è£…VeruséªŒè¯å™¨
2. æ¿€æ´»condaç¯å¢ƒï¼š
   ```bash
   conda activate marker
   ```
3. å®‰è£…ä¾èµ–ï¼š
   ```bash
   pip install "openai>=1.0.0"
   ```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
python verus_auto_prover.py <rust_file_path> --api-key <your_openai_api_key>
```

### å®Œæ•´å‚æ•°

```bash
python verus_auto_prover.py <rust_file_path> \
    --api-key <your_openai_api_key> \
    --max-iterations 5
```

### ç¤ºä¾‹

```bash
python verus_auto_prover.py examples/fibonacci.rs --api-key sk-xxx
```

## æ–‡ä»¶ç»“æ„

å¤„ç†æ–‡ä»¶åï¼Œç³»ç»Ÿä¼šåˆ›å»ºä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼š

```
åŸæ–‡ä»¶ç›®å½•/
â”œâ”€â”€ original_file.rs          # åŸå§‹æ–‡ä»¶
â”œâ”€â”€ original_file-verified.rs # éªŒè¯æˆåŠŸçš„æ–‡ä»¶
â””â”€â”€ History/                  # å†å²æ–‡ä»¶å¤¹
    â”œâ”€â”€ 1.rs                 # ç¬¬1æ¬¡è¿­ä»£
    â”œâ”€â”€ 2.rs                 # ç¬¬2æ¬¡è¿­ä»£
    â””â”€â”€ ...                  # æ›´å¤šè¿­ä»£
```

## Prompté…ç½®

ç³»ç»Ÿä½¿ç”¨`prompts.json`æ–‡ä»¶æ¥é…ç½®promptæ¨¡æ¿ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ï¼š

### ä¸»è¦é…ç½®é¡¹

- `initial_proof_generation`: åˆå§‹è¯æ˜ç”Ÿæˆçš„prompt
- `iterative_fix`: è¿­ä»£ä¿®å¤çš„prompt  
- `model_config`: æ¨¡å‹é…ç½®å‚æ•°

### è‡ªå®šä¹‰Prompt

ç¼–è¾‘`prompts.json`æ–‡ä»¶æ¥è‡ªå®šä¹‰promptï¼š

```json
{
  "initial_proof_generation": {
    "template": "ä½ çš„è‡ªå®šä¹‰prompt..."
  },
  "model_config": {
    "model": "gpt-4o",
    "temperature": 0.1,
    "max_tokens": 4000
  }
}
```

## å·¥ä½œæµç¨‹

1. **è¯»å–è¾“å…¥æ–‡ä»¶**: åŠ è½½åŒ…å«require/ensureçš„Rustä»£ç 
2. **ç”Ÿæˆåˆå§‹è¯æ˜**: ä½¿ç”¨LMç”Ÿæˆç¬¬ä¸€ç‰ˆproof
3. **VeruséªŒè¯**: è¿è¡ŒVeruséªŒè¯å™¨æ£€æŸ¥proof
4. **è¿­ä»£ä¿®å¤**: å¦‚æœéªŒè¯å¤±è´¥ï¼Œæ ¹æ®é”™è¯¯ä¿¡æ¯ä¿®å¤proof
5. **ä¿å­˜ç»“æœ**: éªŒè¯æˆåŠŸåä¿å­˜åˆ°verifiedæ–‡ä»¶

## ç¤ºä¾‹æ–‡ä»¶

### è¾“å…¥ç¤ºä¾‹ (fibonacci.rs)

```rust
use vstd::prelude::*;

verus! {

// è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬né¡¹
fn fibonacci(n: u32) -> (result: u32)
    requires n < 50,  // é˜²æ­¢æº¢å‡º
    ensures result > 0,
{
    if n <= 1 {
        1
    } else {
        fibonacci(n - 1) + fibonacci(n - 2)
    }
}

} // verus!
```

### æœŸæœ›è¾“å‡º (fibonacci-verified.rs)

ç³»ç»Ÿä¼šè‡ªåŠ¨ç”ŸæˆåŒ…å«å®Œæ•´proofçš„éªŒè¯ç‰ˆæœ¬ã€‚

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å¤„ç†å¤æ‚çš„å¾ªç¯è¯æ˜ï¼Ÿ
A: ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«éœ€è¦å¾ªç¯ä¸å˜å¼çš„æƒ…å†µï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„proofä»£ç ã€‚

### Q: éªŒè¯å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
A: ç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œæœ€å¤š5æ¬¡è¿­ä»£ä¿®å¤ï¼Œæ¯æ¬¡éƒ½ä¼šæ ¹æ®Verusçš„é”™è¯¯ä¿¡æ¯ä¼˜åŒ–proofã€‚

### Q: å¦‚ä½•è°ƒæ•´æ¨¡å‹å‚æ•°ï¼Ÿ
A: ç¼–è¾‘`prompts.json`æ–‡ä»¶ä¸­çš„`model_config`éƒ¨åˆ†ã€‚

## APIå¯†é’¥é…ç½®

å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå»ºè®®é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®APIå¯†é’¥ï¼š

```bash
export OPENAI_API_KEY="your_api_key_here"
python verus_auto_prover.py examples/fibonacci.rs --api-key $OPENAI_API_KEY
```

## æ³¨æ„äº‹é¡¹

- ç¡®ä¿è¾“å…¥çš„Rustæ–‡ä»¶åŒ…å«validçš„require/ensureè§„çº¦
- å¯¹äºç‰¹åˆ«å¤æ‚çš„è¯æ˜ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨è°ƒæ•´prompt
- ç³»ç»Ÿä¼šä¿å­˜æ‰€æœ‰ä¸­é—´ç»“æœï¼Œä¾¿äºè°ƒè¯•å’Œåˆ†æ
- å»ºè®®åœ¨å¤„ç†é‡è¦æ–‡ä»¶å‰å…ˆå¤‡ä»½

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªç³»ç»Ÿï¼